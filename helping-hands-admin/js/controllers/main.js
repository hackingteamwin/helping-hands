materialAdmin.controller('materialadminCtrl',function($timeout,api,$localStorage,$rootScope,$state,$scope,growlService,$filter,$location){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){angular.element('html').addClass('ismobile')}
this.sidebarToggle={left:!1,right:!1}
$scope.doTheBack=function(){window.history.back()};$rootScope.logout=function(){var ref=new Firebase(api+"/adminlogin");var today=new Date();var datetime=$filter('date')(today,'dd-MM-yyyy @ h:mma');ref.child('logouttime').set(datetime);ref.child('loginstatus').set('inactive');$localStorage.hhadminlogin=!1;$location.path('login')}
localStorage.setItem('ma-layout-status',0);this.layoutType=localStorage.getItem('ma-layout-status');this.$state=$state;this.sidebarStat=function(event){if(!angular.element(event.target).parent().hasClass('active')){this.sidebarToggle.left=!1}}
this.listviewSearchStat=!1;this.lvSearch=function(){this.listviewSearchStat=!0}
this.lvMenuStat=!1;this.wallCommenting=[];this.wallImage=!1;this.wallVideo=!1;this.wallLink=!1;this.currentSkin='#607D8B';this.skinList=['lightblue','bluegray','cyan','teal','green','orange','blue','purple']
this.skinSwitch=function(color){this.currentSkin=color}}).controller('headerCtrl',function($timeout){}).controller('loginCtrl',function($firebaseArray,api,$filter,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){$localStorage.hhadminlogin=!1;this.login=1;$scope.doTheBack=function(){window.history.back()};$scope.logindata={};$scope.inputType='password';$scope.hideShowPassword=function(){if($scope.inputType=='password')
$scope.inputType='text';else $scope.inputType='password'}
$scope.login=function(logindata){var ref=new Firebase(api+"/adminlogin");var data=$firebaseObject(ref);data.$loaded().then(function(){if(data.username==logindata.username&&data.password==logindata.password){var today=new Date();var datetime=$filter('date')(today,'dd-MM-yyyy @ h:mma');ref.child('logintime').set(datetime);ref.child('loginstatus').set('active');$localStorage.hhadminlogin=!0;$location.path('home')}
else{swal({title:"Alert!",text:"Please enter valid username and password.",type:"warning",confirmButtonColor:"orange",confirmButtonText:"OK"},function(){});$scope.logindata={}}})}}).controller('homeCtrl',function($firebaseArray,api,$filter,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){if($localStorage.hhadminlogin==!1){$location.path('login')}
$scope.doTheBack=function(){window.history.back()};$scope.villagecount=0;$scope.schoolcount=0;$scope.volunteercount=0;$scope.villagedatas=[];$scope.schooldatas=[];$scope.volunteerdatas=[];$scope.employeedatas=[];var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}});schoolref.endAt().limit(1).on('child_added',function(childSnapshot,prevChildKey){var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}})});var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}});villageref.endAt().limit(1).on('child_added',function(childSnapshot,prevChildKey){var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}})});var volunteerref=new Firebase(api+"/volunteers");var volunteerdatas=$firebaseArray(volunteerref);volunteerdatas.$loaded().then(function(){$scope.volunteercount=0;$scope.volunteerdatas=[];for(var i=0;i<volunteerdatas.length;i++){if(volunteerdatas[i].viewstatus==!0){$scope.volunteercount=parseInt($scope.volunteercount)+1;$scope.volunteerdatas.push(volunteerdatas[i])}}
console.log("$scope.volunteerdatas",$scope.volunteerdatas)});volunteerref.endAt().limit(1).on('child_added',function(childSnapshot,prevChildKey){var volunteerdatas=$firebaseArray(volunteerref);volunteerdatas.$loaded().then(function(){$scope.volunteercount=0;$scope.volunteerdatas=[];for(var i=0;i<volunteerdatas.length;i++){if(volunteerdatas[i].viewstatus==!0){$scope.volunteercount=parseInt($scope.volunteercount)+1;$scope.volunteerdatas.push(volunteerdatas[i])}}
console.log("$scope.volunteerdatas",$scope.volunteerdatas)})})}).controller('addvillageCtrl',function($firebaseArray,api,$filter,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){$scope.curPage=0;$scope.pageSize=10;$scope.doTheBack=function(){window.history.back()};var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}
if($scope.villagedatas){$scope.pagenum=Math.ceil($scope.villagedatas.length/$scope.pageSize)}});$scope.numberOfPages=function(data){$scope.pageSize=parseInt(data);$scope.pagenum=Math.ceil($scope.villagedatas.length/parseInt(data))}
$scope.village={};$scope.deletevillage=function(data){var ref=new Firebase(api+"/villages/"+data.$id);var confirm=window.confirm('Are you sure you want to delete this village?');if(confirm==!0){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');ref.child('deletedby').set('admin');ref.child('deleteddate').set(date);ref.child('viewstatus').set(!1);var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}
if($scope.villagedatas){$scope.pagenum=Math.ceil($scope.villagedatas.length/$scope.pageSize)}});swal({title:"Success!",text:"Village deleted successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}
$scope.addvillage=function(data){var ref=new Firebase(api+"/villages");var datas=$firebaseArray(ref);datas.$loaded().then(function(){var testflag=!1;for(var i=0;i<datas.length;i++){if(datas[i].username==data.username){testflag=!0;break}}
if(testflag==!1){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');data.date=date;data.time=time;data.createddate=date;data.createdby='admin';data.viewstatus=!0;ref.push(data);$scope.user={};$location.path('/village/viewvillage');swal({title:"Success!",text:"Village created successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}
else{data.username='';swal({title:"Alert",text:"Username already taken. Try something different.",type:"warning",confirmButtonColor:"orange",confirmButtonText:"OK"},function(){})}})}}).controller('editvillageCtrl',function($firebaseArray,$stateParams,$filter,api,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){var villageref=new Firebase(api+"/villages/"+$stateParams.id);var villagedatas=$firebaseObject(villageref);villagedatas.$loaded().then(function(){$scope.village=villagedatas});$scope.doTheBack=function(){window.history.back()};$scope.send=function(data){console.log("inside",$stateParams.id);var today=new Date();var date=$filter('date')(today,"dd/MM/yyyy @ h:mma");data.username="Admin";data.time=date;var refnew=new Firebase(api+"/villages/"+$stateParams.id+"/groupchat");refnew.push(data);data.text="";$scope.datas=$firebaseArray(refnew);$scope.datas.$loaded().then(function(){if($scope.datas){$scope.length=parseInt($scope.datas.length);console.log("$scope.length",$scope.length)}
else{$scope.length=0}})}
$scope.username="Admin";var ref1=new Firebase(api+"/villages/"+$stateParams.id+"/groupchat");var datas=$firebaseArray(ref1);$scope.datas=datas;datas.$loaded().then(function(){if(datas){$scope.length=parseInt(datas.length);console.log("$scope.length",$scope.length)}
else{$scope.length=0}});$scope.senddirect=function(data){console.log("inside",$stateParams.id);var today=new Date();var date=$filter('date')(today,"dd/MM/yyyy @ h:mma");data.username="Admin";data.time=date;var refnew=new Firebase(api+"/villages/"+$stateParams.id+"/directchat");refnew.push(data);data.text="";$scope.directdatas=$firebaseArray(refnew);$scope.directdatas.$loaded().then(function(){if($scope.directdatas){$scope.directlength=parseInt($scope.directdatas.length);console.log("$scope.length",$scope.directlength)}
else{$scope.directlength=0}})}
var ref2=new Firebase(api+"/villages/"+$stateParams.id+"/directchat");var directdatas=$firebaseArray(ref2);$scope.directdatas=directdatas;directdatas.$loaded().then(function(){if(directdatas){$scope.directlength=parseInt(directdatas.length);console.log("$scope.length",$scope.directlength)}
else{$scope.directlength=0}});$scope.updateimprovement=function(data){var improvementsref=new Firebase(api+"/villages/"+$stateParams.id+"/improvements/"+data.$id);var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');data.date=date;data.time=time;improvementsref.child('date').set(date);improvementsref.child('time').set(time);improvementsref.child('updatedby').set('admin');improvementsref.child('updateddate').set(date);improvementsref.child('impdetails').set(data.impdetails);var improvementsref=new Firebase(api+"/villages/"+$stateParams.id+"/improvements");var improvementsdatas=$firebaseArray(improvementsref);improvementsdatas.$loaded().then(function(){$scope.improvementsdatas=[];for(var i=0;i<improvementsdatas.length;i++){if(improvementsdatas[i].viewstatus==!0){$scope.improvementsdatas.push(improvementsdatas[i])}}});swal({title:"Success!",text:"Improvement data updated successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}
$scope.getimprovement=function(data){var improvementsref=new Firebase(api+"/villages/"+$stateParams.id+"/improvements/"+data.$id);$rootScope.impdata=$firebaseObject(improvementsref)}
$scope.addimprovements=function(data){var improvementsref=new Firebase(api+"/villages/"+$stateParams.id+"/improvements");var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');data.date=date;data.time=time;data.createdby="admin";data.createddate=date;data.viewstatus=!0;improvementsref.push(data);data.impdetails="";var improvementsref=new Firebase(api+"/villages/"+$stateParams.id+"/improvements");var improvementsdatas=$firebaseArray(improvementsref);improvementsdatas.$loaded().then(function(){$scope.improvementsdatas=[];for(var i=0;i<improvementsdatas.length;i++){if(improvementsdatas[i].viewstatus==!0){$scope.improvementsdatas.push(improvementsdatas[i])}}});swal({title:"Success!",text:"Improvement data added successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}
var improvementsref=new Firebase(api+"/villages/"+$stateParams.id+"/improvements");var improvementsdatas=$firebaseArray(improvementsref);improvementsdatas.$loaded().then(function(){$scope.improvementsdatas=[];for(var i=0;i<improvementsdatas.length;i++){if(improvementsdatas[i].viewstatus==!0){$scope.improvementsdatas.push(improvementsdatas[i])}}});$scope.deleteimprovement=function(data){var improvementsref=new Firebase(api+"/villages/"+$stateParams.id+"/improvements/"+data.$id);var confirm=window.confirm("Do you want to delete this improvement");if(confirm){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');improvementsref.child('deletedby').set('admin');improvementsref.child('deleteddate').set(date);improvementsref.child('viewstatus').set(!1);var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements");var improvementsdatas=$firebaseArray(improvementsref);improvementsdatas.$loaded().then(function(){$scope.improvementsdatas=[];for(var i=0;i<improvementsdatas.length;i++){if(improvementsdatas[i].viewstatus==!0){$scope.improvementsdatas.push(improvementsdatas[i])}}});swal({title:"Success!",text:"Improvement data deleted successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}
$scope.updatevillage=function(data){var ref=new Firebase(api+"/villages/"+data.$id);var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');ref.child('date').set(date);ref.child('time').set(time);ref.child('updateddate').set(date);ref.child('updatedby').set('admin');ref.child('villagename').set(data.villagename);ref.child('mobile').set(data.mobile);ref.child('city').set(data.city);ref.child('state').set(data.state);ref.child('noofpeople').set(data.noofpeople);ref.child('username').set(data.username);ref.child('password').set(data.password);if(data.email){ref.child('email').set(data.email)}
$location.path('/village/viewvillage');swal({title:"Success!",text:"Village data updated successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}).controller('addschoolCtrl',function($firebaseArray,api,$filter,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){$scope.curPage=0;$scope.pageSize=10;$scope.doTheBack=function(){window.history.back()};var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}
if($scope.schooldatas){$scope.pagenum=Math.ceil($scope.schooldatas.length/$scope.pageSize)}});$scope.numberOfPages=function(data){$scope.pageSize=parseInt(data);$scope.pagenum=Math.ceil($scope.schooldatas.length/parseInt(data))}
$scope.school={};$scope.deleteschool=function(data){var ref=new Firebase(api+"/schools/"+data.$id);var confirm=window.confirm('Are you sure you want to delete this school?');if(confirm==!0){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');ref.child('deletedby').set('admin');ref.child('deleteddate').set(date);ref.child('viewstatus').set(!1);var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}
if($scope.schooldatas){$scope.pagenum=Math.ceil($scope.schooldatas.length/$scope.pageSize)}});swal({title:"Success!",text:"School deleted successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}
$scope.addschool=function(data){var ref=new Firebase(api+"/schools");var datas=$firebaseArray(ref);datas.$loaded().then(function(){var testflag=!1;for(var i=0;i<datas.length;i++){if(datas[i].username==data.username){testflag=!0;break}}
if(testflag==!1){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');data.time=time;data.date=date;data.createddate=date;data.createdby='admin';data.viewstatus=!0;ref.push(data);$scope.school={};$location.path('/school/viewschool');swal({title:"Success!",text:"School created successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}
else{data.username='';swal({title:"Alert",text:"Username already taken. Try something different.",type:"warning",confirmButtonColor:"orange",confirmButtonText:"OK"},function(){})}})}}).controller('editschoolCtrl',function($firebaseArray,$stateParams,$filter,api,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){var schoolref=new Firebase(api+"/schools/"+$stateParams.id);var schooldatas=$firebaseObject(schoolref);schooldatas.$loaded().then(function(){$scope.school=schooldatas});$scope.doTheBack=function(){window.history.back()};$scope.send=function(data){console.log("inside",$stateParams.id);var today=new Date();var date=$filter('date')(today,"dd/MM/yyyy @ h:mma");data.username="Admin";data.time=date;var refnew=new Firebase(api+"/schools/"+$stateParams.id+"/groupchat");refnew.push(data);data.text="";$scope.datas=$firebaseArray(refnew);$scope.datas.$loaded().then(function(){if($scope.datas){$scope.length=parseInt($scope.datas.length);console.log("$scope.length",$scope.length)}
else{$scope.length=0}})}
$scope.username="Admin";var ref1=new Firebase(api+"/schools/"+$stateParams.id+"/groupchat");var datas=$firebaseArray(ref1);$scope.datas=datas;datas.$loaded().then(function(){if(datas){$scope.length=parseInt(datas.length);console.log("$scope.length",$scope.length)}
else{$scope.length=0}});$scope.senddirect=function(data){console.log("inside",$stateParams.id);var today=new Date();var date=$filter('date')(today,"dd/MM/yyyy @ h:mma");data.username="Admin";data.time=date;var refnew=new Firebase(api+"/schools/"+$stateParams.id+"/directchat");refnew.push(data);data.text="";$scope.directdatas=$firebaseArray(refnew);$scope.directdatas.$loaded().then(function(){if($scope.directdatas){$scope.directlength=parseInt($scope.directdatas.length);console.log("$scope.length",$scope.directlength)}
else{$scope.directlength=0}})}
var ref2=new Firebase(api+"/schools/"+$stateParams.id+"/directchat");var directdatas=$firebaseArray(ref2);$scope.directdatas=directdatas;directdatas.$loaded().then(function(){if(directdatas){$scope.directlength=parseInt(directdatas.length);console.log("$scope.length",$scope.directlength)}
else{$scope.directlength=0}});$scope.updateimprovement=function(data){var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements/"+data.$id);var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');improvementsref.child('date').set(date);improvementsref.child('time').set(time);improvementsref.child('updatedby').set('admin');improvementsref.child('updateddate').set(date);improvementsref.child('impdetails').set(data.impdetails);var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements");var improvementsdatas=$firebaseArray(improvementsref);improvementsdatas.$loaded().then(function(){$scope.improvementsdatas=[];for(var i=0;i<improvementsdatas.length;i++){if(improvementsdatas[i].viewstatus==!0){$scope.improvementsdatas.push(improvementsdatas[i])}}});swal({title:"Success!",text:"Improvement data updated successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}
$scope.getimprovement=function(data){var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements/"+data.$id);$rootScope.impdata=$firebaseObject(improvementsref)}
$scope.addimprovements=function(data){var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements");var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');data.time=time;data.date=date;data.createdby="admin";data.createddate=date;data.viewstatus=!0;improvementsref.push(data);data.impdetails="";var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements");var improvementsdatas=$firebaseArray(improvementsref);improvementsdatas.$loaded().then(function(){$scope.improvementsdatas=[];for(var i=0;i<improvementsdatas.length;i++){if(improvementsdatas[i].viewstatus==!0){$scope.improvementsdatas.push(improvementsdatas[i])}}});swal({title:"Success!",text:"Improvement data added successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}
var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements");var improvementsdatas=$firebaseArray(improvementsref);improvementsdatas.$loaded().then(function(){$scope.improvementsdatas=[];for(var i=0;i<improvementsdatas.length;i++){if(improvementsdatas[i].viewstatus==!0){$scope.improvementsdatas.push(improvementsdatas[i])}}});$scope.deleteimprovement=function(data){var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements/"+data.$id);var confirm=window.confirm("Do you want to delete this improvement");if(confirm){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');improvementsref.child('deletedby').set('admin');improvementsref.child('deleteddate').set(date);improvementsref.child('viewstatus').set(!1);var improvementsref=new Firebase(api+"/schools/"+$stateParams.id+"/improvements");var improvementsdatas=$firebaseArray(improvementsref);improvementsdatas.$loaded().then(function(){$scope.improvementsdatas=[];for(var i=0;i<improvementsdatas.length;i++){if(improvementsdatas[i].viewstatus==!0){$scope.improvementsdatas.push(improvementsdatas[i])}}});swal({title:"Success!",text:"Improvement data deleted successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}
$scope.updateschool=function(data){var ref=new Firebase(api+"/schools/"+data.$id);var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');ref.child('date').set(date);ref.child('time').set(time);ref.child('updateddate').set(date);ref.child('updatedby').set('admin');ref.child('schoolname').set(data.schoolname);ref.child('address').set(data.address);ref.child('mobile').set(data.mobile);if(data.city){ref.child('city').set(data.city)}
if(data.state){ref.child('state').set(data.state)}
ref.child('noofstudents').set(data.noofstudents);ref.child('username').set(data.username);ref.child('password').set(data.password);if(data.email){ref.child('email').set(data.email)}
$location.path('/school/viewschool');swal({title:"Success!",text:"School data updated successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}).controller('addvolunteerCtrl',function($firebaseArray,api,$filter,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){$scope.curPage=0;$scope.pageSize=10;$scope.doTheBack=function(){window.history.back()};$scope.assign=function(data){var volunteerref=new Firebase(api+"/volunteers/"+data);var confirm=window.confirm("Are you sure you want to accept this volunteer for volunteering?");if(confirm){volunteerref.child('assignedstatus').set(!0)}}
$scope.notassign=function(data){var volunteerref=new Firebase(api+"/volunteers/"+data);var confirm=window.confirm("Are you sure you want to remove this volunteer from volunteering?");if(confirm){volunteerref.child('assignedstatus').set(!1)}}
var volunteerref=new Firebase(api+"/volunteers");var volunteerdatas=$firebaseArray(volunteerref);volunteerdatas.$loaded().then(function(){$scope.volunteercount=0;$scope.volunteerdatas=[];for(var i=0;i<volunteerdatas.length;i++){if(volunteerdatas[i].viewstatus==!0){$scope.volunteercount=parseInt($scope.volunteercount)+1;$scope.volunteerdatas.push(volunteerdatas[i])}}
if($scope.volunteerdatas){$scope.pagenum=Math.ceil($scope.volunteerdatas.length/$scope.pageSize)}});$scope.numberOfPages=function(data){$scope.pageSize=parseInt(data);$scope.pagenum=Math.ceil($scope.volunteerdatas.length/parseInt(data))}
$scope.getdetail=function(data){var volunteerref=new Firebase(api+"/volunteers/"+data);var volunteerdatas=$firebaseObject(volunteerref);volunteerdatas.$loaded().then(function(){$rootScope.datanow=volunteerdatas})}
$scope.volunteer={};$scope.deletevolunteer=function(data){var ref=new Firebase(api+"/volunteers/"+data.$id);var confirm=window.confirm('Are you sure you want to delete this volunteer?');if(confirm==!0){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');ref.child('deletedby').set('admin');ref.child('deleteddate').set(date);ref.child('viewstatus').set(!1);var volunteerref=new Firebase(api+"/volunteers");var volunteerdatas=$firebaseArray(volunteerref);volunteerdatas.$loaded().then(function(){$scope.volunteercount=0;$scope.volunteerdatas=[];for(var i=0;i<volunteerdatas.length;i++){if(volunteerdatas[i].viewstatus==!0){$scope.volunteercount=parseInt($scope.volunteercount)+1;$scope.volunteerdatas.push(volunteerdatas[i])}}
if($scope.volunteerdatas){$scope.pagenum=Math.ceil($scope.volunteerdatas.length/$scope.pageSize)}});swal({title:"Success!",text:"Volunteer deleted successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}
$scope.getvname=function(data){console.log("inside getvname");$scope.nowschoolname=null;$scope.nowsmobile=null;$scope.volunteer.school=null;var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].username==data){$scope.nowvillagename=villagedatas[i].villagename;$scope.nowmobile=villagedatas[i].mobile}}})}
$scope.getsname=function(data){console.log("inside getsname");$scope.nowvillagename=null;$scope.nowmobile=null;$scope.volunteer.village=null;var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].username==data){$scope.nowschoolname=schooldatas[i].schoolname;$scope.nowsmobile=schooldatas[i].mobile}}})}
$scope.getdata=function(data){if(data=="Village"){var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}})}
else if(data=="School"){var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}})}}
$scope.addvolunteer=function(data){var ref=new Firebase(api+"/volunteers");var datas=$firebaseArray(ref);datas.$loaded().then(function(){var testflag=!1;for(var i=0;i<datas.length;i++){if(datas[i].username==data.username){testflag=!0;break}}
if(testflag==!1){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');data.createddate=date;var time=$filter('date')(today,'h:mma');data.time=time;data.date=date;data.createdby='admin';data.viewstatus=!0;data.assignedstatus=!1;if($scope.nowmobile){data.villagemobile=$scope.nowmobile}
if($scope.nowsmobile){data.schoolmobile=$scope.nowsmobile}
if($scope.nowvillagename){data.villagename=$scope.nowvillagename}
if($scope.nowschoolname){data.schoolname=$scope.nowschoolname}
ref.push(data);$scope.volunteer={};$location.path('/volunteer/viewvolunteer');swal({title:"Success!",text:"Volunteer created successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}
else{data.username='';swal({title:"Alert",text:"Username already taken. Try something different.",type:"warning",confirmButtonColor:"orange",confirmButtonText:"OK"},function(){})}})}}).controller('editvolunteerCtrl',function($firebaseArray,$stateParams,$filter,api,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){var volunteerref=new Firebase(api+"/volunteers/"+$stateParams.id);var volunteerdatas=$firebaseObject(volunteerref);volunteerdatas.$loaded().then(function(){$scope.volunteer=volunteerdatas;if($scope.volunteer.interested=="Village"){$scope.nowmobile=$scope.volunteer.villagemobile;$scope.nowvillagename=$scope.volunteer.villagename}
if($scope.volunteer.interested=="School"){$scope.nowsmobile=$scope.volunteer.schoolmobile;$scope.nowschoolname=$scope.volunteer.schoolname}
if($scope.volunteer.interested=="Village"){var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}})}
else if($scope.volunteer.interested=="School"){var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}})}});$scope.doTheBack=function(){window.history.back()};$scope.send=function(data){console.log("inside",$stateParams.id);var today=new Date();var date=$filter('date')(today,"dd/MM/yyyy @ h:mma");data.username="Admin";data.time=date;var refnew=new Firebase(api+"/volunteers/"+$stateParams.id+"/directchat");refnew.push(data);data.text="";$scope.datas=$firebaseArray(refnew);$scope.datas.$loaded().then(function(){if($scope.datas){$scope.length=parseInt($scope.datas.length);console.log("$scope.length",$scope.length)}
else{$scope.length=0}})}
$scope.username="Admin";var ref1=new Firebase(api+"/volunteers/"+$stateParams.id+"/directchat");var datas=$firebaseArray(ref1);$scope.datas=datas;datas.$loaded().then(function(){if(datas){$scope.length=parseInt(datas.length);console.log("$scope.length",$scope.length)}
else{$scope.length=0}});var reflink=new Firebase(api+"/volunteers/"+$stateParams.id+"/myactivities");var nowdatas=$firebaseArray(reflink);nowdatas.$loaded().then(function(){$scope.activitydata=nowdatas});$scope.getdata=function(data){if(data=="Village"){var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}})}
else if(data=="School"){var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}})}}
$scope.getvname=function(data){console.log("inside getvname");$scope.nowschoolname=null;$scope.nowsmobile=null;$scope.volunteer.school=null;var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].username==data){$scope.nowvillagename=villagedatas[i].villagename;$scope.nowmobile=villagedatas[i].mobile}}})}
$scope.getsname=function(data){console.log("inside getsname");$scope.nowvillagename=null;$scope.nowmobile=null;$scope.volunteer.village=null;var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].username==data){$scope.nowschoolname=schooldatas[i].schoolname;$scope.nowsmobile=schooldatas[i].mobile}}})}
$scope.updatevolunteer=function(data){console.log("data",data,$scope.volunteer);var ref=new Firebase(api+"/volunteers/"+data.$id);var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');ref.child('date').set(date);ref.child('time').set(time);ref.child('updateddate').set(date);ref.child('updatedby').set('admin');ref.child('volunteername').set(data.volunteername);if(data.address){ref.child('address').set(data.address)}
ref.child('mobile').set(data.mobile);ref.child('city').set(data.city);ref.child('state').set(data.state);ref.child('interested').set(data.interested);ref.child('school').set(null);ref.child('village').set(null);if($scope.volunteer.school){ref.child('school').set(data.school);ref.child('schoolmobile').set($scope.nowsmobile);ref.child('schoolname').set($scope.nowschoolname);if(data.village||$scope.volunteer.village){ref.child('village').set(null)}
if(data.villagemobile){ref.child('villagemobile').set(null)}
if(data.villagename){ref.child('villagename').set(null)}}
if($scope.volunteer.village){ref.child('village').set(data.village);ref.child('villagemobile').set($scope.nowmobile);ref.child('villagename').set($scope.nowvillagename);if(data.school||$scope.volunteer.school){ref.child('school').set(null)}
if(data.schoolmobile){ref.child('schoolmobile').set(null)}
if(data.schoolname){ref.child('schoolname').set(null)}}
ref.child('username').set(data.username);ref.child('password').set(data.password);if(data.email){ref.child('email').set(data.email)}
if(data.worksdone){ref.child('worksdone').set(data.worksdone)}
if(data.otherdetails){ref.child('otherdetails').set(data.otherdetails)}
$location.path('/volunteer/viewvolunteer');swal({title:"Success!",text:"Volunteer data updated successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}).controller('chatCtrl',function($firebaseArray,$stateParams,$filter,api,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){$scope.send=function(data){console.log("inside",$stateParams.id);var today=new Date();var date=$filter('date')(today,"dd/MM/yyyy @ h:mma");data.username="Admin";data.time=date;var refnew=new Firebase(api+"/commonchat");refnew.push(data);data.text="";$scope.datas=$firebaseArray(refnew);$scope.datas.$loaded().then(function(){if($scope.datas){$scope.length=parseInt($scope.datas.length);console.log("$scope.length",$scope.length)}
else{$scope.length=0}})}
$scope.username="Admin";var ref1=new Firebase(api+"/commonchat");var datas=$firebaseArray(ref1);$scope.datas=datas;datas.$loaded().then(function(){if(datas){$scope.length=parseInt(datas.length);console.log("$scope.length",$scope.length)}
else{$scope.length=0}})}).controller('addneedsCtrl',function($firebaseArray,api,$filter,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){$scope.curPage=0;$scope.pageSize=10;$scope.doTheBack=function(){window.history.back()};$scope.markdone=function(data){var confirm=window.confirm("Do want to mark this needs as done?");if(confirm==!0){var needsref=new Firebase(api+"/needs/"+data.$id);needsref.child("donestatus").set(!0)}}
$scope.marknotdone=function(data){var confirm=window.confirm("Do want to mark this needs as not done?");if(confirm==!0){var needsref=new Firebase(api+"/needs/"+data.$id);needsref.child("donestatus").set(!1)}}
var needsref=new Firebase(api+"/needs");var needsdatas=$firebaseArray(needsref);needsdatas.$loaded().then(function(){$scope.needscount=0;$scope.needsdatas=[];for(var i=0;i<needsdatas.length;i++){if(needsdatas[i].viewstatus==!0){$scope.needscount=parseInt($scope.needscount)+1;$scope.needsdatas.push(needsdatas[i])}}
if($scope.needsdatas){$scope.pagenum=Math.ceil($scope.needsdatas.length/$scope.pageSize)}});$scope.numberOfPages=function(data){$scope.pageSize=parseInt(data);$scope.pagenum=Math.ceil($scope.needsdatas.length/parseInt(data))}
$scope.getdetail=function(data){var needsref=new Firebase(api+"/needs/"+data);var needsdatas=$firebaseObject(needsref);needsdatas.$loaded().then(function(){$rootScope.needsdata=needsdatas})}
$scope.getvname=function(data){var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);$scope.nowschoolname=null;$scope.nowsmobile=null;$scope.needs.school=null;villagedatas.$loaded().then(function(){for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].username==data){$scope.nowvillagename=villagedatas[i].villagename;$scope.nowmobile=villagedatas[i].mobile}}})}
$scope.getsname=function(data){var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);$scope.nowvillagename=null;$scope.nowmobile=null;$scope.needs.village=null;schooldatas.$loaded().then(function(){for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].username==data){$scope.nowschoolname=schooldatas[i].schoolname;$scope.nowsmobile=schooldatas[i].mobile}}})}
$scope.needs={};$scope.deleteneeds=function(data){var ref=new Firebase(api+"/needs/"+data.$id);var confirm=window.confirm('Are you sure you want to delete this need?');if(confirm==!0){var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');ref.child('deletedby').set('admin');ref.child('deleteddate').set(date);ref.child('viewstatus').set(!1);var needsref=new Firebase(api+"/needs");var needsdatas=$firebaseArray(needsref);needsdatas.$loaded().then(function(){$scope.needscount=0;$scope.needsdatas=[];for(var i=0;i<needsdatas.length;i++){if(needsdatas[i].viewstatus==!0){$scope.needscount=parseInt($scope.needscount)+1;$scope.needsdatas.push(needsdatas[i])}}
if($scope.needsdatas){$scope.pagenum=Math.ceil($scope.needsdatas.length/$scope.pageSize)}});swal({title:"Success!",text:"Needs deleted successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}
$scope.getdata=function(data){if(data=="Village"){var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}})}
else if(data=="School"){var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}})}}
$scope.addneeds=function(data){var ref=new Firebase(api+"/needs");var datas=$firebaseArray(ref);var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');data.time=time;data.date=date;data.createddate=date;data.createdby='admin';data.donestatus=!1;data.viewstatus=!0;if($scope.nowmobile){data.villagemobile=$scope.nowmobile}
if($scope.nowsmobile){data.schoolmobile=$scope.nowsmobile}
if($scope.nowvillagename){data.villagename=$scope.nowvillagename}
if($scope.nowschoolname){data.schoolname=$scope.nowschoolname}
ref.push(data);$scope.volunteer={};$location.path('/needs/viewneeds');swal({title:"Success!",text:"Needs created successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}).controller('editneedsCtrl',function($firebaseArray,$stateParams,$filter,api,Flash,$location,$firebaseObject,$scope,$rootScope,$localStorage){var needsref=new Firebase(api+"/needs/"+$stateParams.id);var needsdatas=$firebaseObject(needsref);needsdatas.$loaded().then(function(){$scope.need=needsdatas;console.log("$scope.need",$scope.need);if($scope.need.type=="Village"){$scope.nowmobile=$scope.need.villagemobile;$scope.nowvillagename=$scope.need.villagename}
if($scope.need.type=="School"){$scope.nowsmobile=$scope.need.schoolmobile;$scope.nowschoolname=$scope.need.schoolname}
if($scope.need.type=="Village"){var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}})}
else if($scope.need.type=="School"){var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}})}});$scope.doTheBack=function(){window.history.back()};$scope.getvname=function(data){var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);$scope.nowschoolname=null;$scope.nowsmobile=null;$scope.needs.school=null;villagedatas.$loaded().then(function(){for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].username==data){$scope.nowvillagename=villagedatas[i].villagename;$scope.nowmobile=villagedatas[i].mobile}}})}
$scope.getsname=function(data){var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);$scope.nowvillagename=null;$scope.nowmobile=null;$scope.needs.village=null;schooldatas.$loaded().then(function(){for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].username==data){$scope.nowschoolname=schooldatas[i].schoolname;$scope.nowsmobile=schooldatas[i].mobile}}})}
$scope.getdata=function(data){if(data=="Village"){var villageref=new Firebase(api+"/villages");var villagedatas=$firebaseArray(villageref);villagedatas.$loaded().then(function(){$scope.villagecount=0;$scope.villagedatas=[];for(var i=0;i<villagedatas.length;i++){if(villagedatas[i].viewstatus==!0){$scope.villagecount=parseInt($scope.villagecount)+1;$scope.villagedatas.push(villagedatas[i])}}})}
else if(data=="School"){var schoolref=new Firebase(api+"/schools");var schooldatas=$firebaseArray(schoolref);schooldatas.$loaded().then(function(){$scope.schoolcount=0;$scope.schooldatas=[];for(var i=0;i<schooldatas.length;i++){if(schooldatas[i].viewstatus==!0){$scope.schoolcount=parseInt($scope.schoolcount)+1;$scope.schooldatas.push(schooldatas[i])}}})}}
$scope.updateneeds=function(data){var ref=new Firebase(api+"/needs/"+data.$id);var today=new Date();var date=$filter('date')(today,'dd-MM-yyyy');var time=$filter('date')(today,'h:mma');ref.child('date').set(date);ref.child('time').set(time);ref.child('updateddate').set(date);ref.child('updatedby').set('admin');ref.child('title').set(data.title);ref.child('details').set(data.details);ref.child('type').set(data.type);if(data.school){ref.child('school').set(data.school);ref.child('schoolmobile').set($scope.nowsmobile);ref.child('schoolname').set($scope.nowschoolname);if(data.village){ref.child('village').set(null)}
if(data.villagemobile){ref.child('villagemobile').set(null)}
if(data.villagename){ref.child('villagename').set(null)}}
if(data.village){ref.child('village').set(data.village);ref.child('villagemobile').set($scope.nowmobile);ref.child('villagename').set($scope.nowvillagename);if(data.school){ref.child('school').set(null)}
if(data.schoolmobile){ref.child('schoolmobile').set(null)}
if(data.schoolname){ref.child('schoolname').set(null)}}
$location.path('/needs/viewneeds');swal({title:"Success!",text:"Needs updated successfully.",type:"success",confirmButtonColor:"green",confirmButtonText:"OK"},function(){})}}).directive('image',function($q){'use strict'
var URL=window.URL||window.webkitURL;var getResizeArea=function(){var resizeAreaId='fileupload-resize-area';var resizeArea=document.getElementById(resizeAreaId);if(!resizeArea){resizeArea=document.createElement('canvas');resizeArea.id=resizeAreaId;resizeArea.style.visibility='hidden';document.body.appendChild(resizeArea)}
return resizeArea}
var resizeImage=function(origImage,options){var maxHeight=options.resizeMaxHeight||300;var maxWidth=options.resizeMaxWidth||250;var quality=options.resizeQuality||0.7;var type=options.resizeType||'image/jpg';var canvas=getResizeArea();var height=origImage.height;var width=origImage.width;if(width>height){if(width>maxWidth){height=Math.round(height*=maxWidth/width);width=maxWidth}}else{if(height>maxHeight){width=Math.round(width*=maxHeight/height);height=maxHeight}}
canvas.width=width;canvas.height=height;var ctx=canvas.getContext("2d");ctx.drawImage(origImage,0,0,width,height);return canvas.toDataURL(type,quality)};var createImage=function(url,callback){var image=new Image();image.onload=function(){callback(image)};image.src=url};var fileToDataURL=function(file){var deferred=$q.defer();var reader=new FileReader();reader.onload=function(e){deferred.resolve(e.target.result)};reader.readAsDataURL(file);return deferred.promise};return{restrict:'A',scope:{image:'=',resizeMaxHeight:'@?',resizeMaxWidth:'@?',resizeQuality:'@?',resizeType:'@?',},link:function postLink(scope,element,attrs,ctrl){var doResizing=function(imageResult,callback){createImage(imageResult.url,function(image){var dataURL=resizeImage(image,scope);imageResult.resized={dataURL:dataURL,type:dataURL.match(/:(.+\/.+);/)[1],};callback(imageResult)})};var applyScope=function(imageResult){scope.$apply(function(){if(attrs.multiple)
scope.image.push(imageResult);else scope.image=imageResult})};element.bind('change',function(evt){if(attrs.multiple)
scope.image=[];var files=evt.target.files;for(var i=0;i<files.length;i++){var imageResult={file:files[i],url:URL.createObjectURL(files[i])};fileToDataURL(files[i]).then(function(dataURL){imageResult.dataURL=dataURL});if(scope.resizeMaxHeight||scope.resizeMaxWidth){doResizing(imageResult,function(imageResult){applyScope(imageResult)})}
else{applyScope(imageResult)}}})}}}).directive('onlyDigits',function(){return{require:'ngModel',restrict:'A',link:function(scope,element,attr,ctrl){function inputValue(val){if(val){var digits=val.replace(/[^0-9, +]/g,'');if(digits!==val){ctrl.$setViewValue(digits);ctrl.$render()}
return parseInt(digits,10)}
return undefined}
ctrl.$parsers.push(inputValue)}}}).directive('ngEnter',function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){if(event.which===13){scope.$apply(function(){scope.$eval(attrs.ngEnter)});event.preventDefault()}})}}).filter('reverse',function(){return function(items){return items.slice().reverse()}}).filter('pagination',function()
{return function(input,start)
{start=+start;return input.slice(start)}}).filter('nl2br',['$filter',function($filter){return function(data){if(!data)return data;return data.replace(/\n\r?/g,'<br />')}}]).directive('autolinker',['$timeout',function($timeout){return{restrict:'A',link:function(scope,element,attrs){$timeout(function(){var eleHtml=element.html();if(eleHtml===''){return!1}
var text=Autolinker.link(eleHtml,{className:'autolinker',newWindow:!1});element.html(text);var autolinks=element[0].getElementsByClassName('autolinker');for(var i=0;i<autolinks.length;i++){angular.element(autolinks[i]).bind('click',function(e){var href=e.target.href;console.log('autolinkClick, href: '+href);if(href){window.open(href,'_blank')}
e.preventDefault();return!1})}},0)}}}]).constant('msdElasticConfig',{append:''}).directive('msdElastic',['$timeout','$window','msdElasticConfig',function($timeout,$window,config){'use strict';return{require:'ngModel',restrict:'A, C',link:function(scope,element,attrs,ngModel){var ta=element[0],$ta=element;if(ta.nodeName!=='TEXTAREA'||!$window.getComputedStyle){return}
$ta.css({'overflow':'hidden','overflow-y':'hidden','word-wrap':'break-word'});var text=ta.value;ta.value='';ta.value=text;var append=attrs.msdElastic?attrs.msdElastic.replace(/\\n/g,'\n'):config.append,$win=angular.element($window),mirrorInitStyle='position: absolute; top: -999px; right: auto; bottom: auto;'+'left: 0; overflow: hidden; -webkit-box-sizing: content-box;'+'-moz-box-sizing: content-box; box-sizing: content-box;'+'min-height: 0 !important; height: 0 !important; padding: 0;'+'word-wrap: break-word; border: 0;',$mirror=angular.element('<textarea tabindex="-1" '+'style="'+mirrorInitStyle+'"/>').data('elastic',!0),mirror=$mirror[0],taStyle=getComputedStyle(ta),resize=taStyle.getPropertyValue('resize'),borderBox=taStyle.getPropertyValue('box-sizing')==='border-box'||taStyle.getPropertyValue('-moz-box-sizing')==='border-box'||taStyle.getPropertyValue('-webkit-box-sizing')==='border-box',boxOuter=!borderBox?{width:0,height:0}:{width:parseInt(taStyle.getPropertyValue('border-right-width'),10)+parseInt(taStyle.getPropertyValue('padding-right'),10)+parseInt(taStyle.getPropertyValue('padding-left'),10)+parseInt(taStyle.getPropertyValue('border-left-width'),10),height:parseInt(taStyle.getPropertyValue('border-top-width'),10)+parseInt(taStyle.getPropertyValue('padding-top'),10)+parseInt(taStyle.getPropertyValue('padding-bottom'),10)+parseInt(taStyle.getPropertyValue('border-bottom-width'),10)},minHeightValue=parseInt(taStyle.getPropertyValue('min-height'),10),heightValue=parseInt(taStyle.getPropertyValue('height'),10),minHeight=Math.max(minHeightValue,heightValue)-boxOuter.height,maxHeight=parseInt(taStyle.getPropertyValue('max-height'),10),mirrored,active,copyStyle=['font-family','font-size','font-weight','font-style','letter-spacing','line-height','text-transform','word-spacing','text-indent'];if($ta.data('elastic')){return}
maxHeight=maxHeight&&maxHeight>0?maxHeight:9e4;if(mirror.parentNode!==document.body){angular.element(document.body).append(mirror)}
$ta.css({'resize':(resize==='none'||resize==='vertical')?'none':'horizontal'}).data('elastic',!0);function initMirror(){var mirrorStyle=mirrorInitStyle;mirrored=ta;taStyle=getComputedStyle(ta);angular.forEach(copyStyle,function(val){mirrorStyle+=val+':'+taStyle.getPropertyValue(val)+';'});mirror.setAttribute('style',mirrorStyle)}
function adjust(){var taHeight,taComputedStyleWidth,mirrorHeight,width,overflow;if(mirrored!==ta){initMirror()}
if(!active){active=!0;mirror.value=ta.value+append;mirror.style.overflowY=ta.style.overflowY;taHeight=ta.style.height===''?'auto':parseInt(ta.style.height,10);taComputedStyleWidth=getComputedStyle(ta).getPropertyValue('width');if(taComputedStyleWidth.substr(taComputedStyleWidth.length-2,2)==='px'){width=parseInt(taComputedStyleWidth,10)-boxOuter.width;mirror.style.width=width+'px'}
mirrorHeight=mirror.scrollHeight;if(mirrorHeight>maxHeight){mirrorHeight=maxHeight;overflow='scroll'}else if(mirrorHeight<minHeight){mirrorHeight=minHeight}
mirrorHeight+=boxOuter.height;ta.style.overflowY=overflow||'hidden';if(taHeight!==mirrorHeight){ta.style.height=mirrorHeight+'px';scope.$emit('elastic:resize',$ta)}
scope.$emit('taResize',$ta);$timeout(function(){active=!1},1)}}
function forceAdjust(){active=!1;adjust()}
if('onpropertychange' in ta&&'oninput' in ta){ta.oninput=ta.onkeyup=adjust}else{ta.oninput=adjust}
$win.bind('resize',forceAdjust);scope.$watch(function(){return ngModel.$modelValue},function(newValue){forceAdjust()});scope.$on('elastic:adjust',function(){initMirror();forceAdjust()});$timeout(adjust);scope.$on('$destroy',function(){$mirror.remove();$win.unbind('resize',forceAdjust)})}}}])
!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.Autolinker=b()}(this,function(){var a=function(b){a.Util.assign(this,b),this.matchValidator=new a.MatchValidator};return a.prototype={constructor:a,urls:!0,email:!0,twitter:!0,newWindow:!0,stripPrefix:!0,className:"",htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;)/gi,matcherRegex:function(){var a=/(^|[^\w])@(\w{1,15})/,b=/(?:[\-;:&=\+\$,\w\.]+@)/,c=/(?:[A-Za-z][-.+A-Za-z0-9]+:(?![A-Za-z][-.+A-Za-z0-9]+:\/\/)(?!\d+\/?)(?:\/\/)?)/,d=/(?:www\.)/,e=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,f=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,g=/[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]?!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]]/;return new RegExp(["(",a.source,")","|","(",b.source,e.source,f.source,")","|","(","(?:","(",c.source,e.source,")","|","(?:","(.?//)?",d.source,e.source,")","|","(?:","(.?//)?",e.source,f.source,")",")","(?:"+g.source+")?",")"].join(""),"gi")}(),charBeforeProtocolRelMatchRegex:/^(.)?\/\//,link:function(b){var c=this,d=this.getHtmlParser(),e=this.htmlCharacterEntitiesRegex,f=0,g=[];return d.parse(b,{processHtmlNode:function(a,b,c){"a"===b&&(c?f=Math.max(f-1,0):f++),g.push(a)},processTextNode:function(b){if(0===f)for(var d=a.Util.splitAndCapture(b,e),h=0,i=d.length;i>h;h++){var j=d[h],k=c.processTextNode(j);g.push(k)}else g.push(b)}}),g.join("")},getHtmlParser:function(){var b=this.htmlParser;return b||(b=this.htmlParser=new a.HtmlParser),b},getTagBuilder:function(){var b=this.tagBuilder;return b||(b=this.tagBuilder=new a.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),b},processTextNode:function(a){var b=this;return a.replace(this.matcherRegex,function(a,c,d,e,f,g,h,i,j){var k=b.processCandidateMatch(a,c,d,e,f,g,h,i,j);if(k){var l=b.createMatchReturnVal(k.match,k.matchStr);return k.prefixStr+l+k.suffixStr}return a})},processCandidateMatch:function(b,c,d,e,f,g,h,i,j){var k,l=i||j,m="",n="";if(c&&!this.twitter||f&&!this.email||g&&!this.urls||!this.matchValidator.isValidMatch(g,h,l))return null;if(this.matchHasUnbalancedClosingParen(b)&&(b=b.substr(0,b.length-1),n=")"),f)k=new a.match.Email({matchedText:b,email:f});else if(c)d&&(m=d,b=b.slice(1)),k=new a.match.Twitter({matchedText:b,twitterHandle:e});else{if(l){var o=l.match(this.charBeforeProtocolRelMatchRegex)[1]||"";o&&(m=o,b=b.slice(1))}k=new a.match.Url({matchedText:b,url:b,protocolUrlMatch:!!h,protocolRelativeMatch:!!l,stripPrefix:this.stripPrefix})}return{prefixStr:m,suffixStr:n,matchStr:b,match:k}},matchHasUnbalancedClosingParen:function(a){var b=a.charAt(a.length-1);if(")"===b){var c=a.match(/\(/g),d=a.match(/\)/g),e=c&&c.length||0,f=d&&d.length||0;if(f>e)return!0}return!1},createMatchReturnVal:function(b,c){var d;if(this.replaceFn&&(d=this.replaceFn.call(this,this,b)),"string"==typeof d)return d;if(d===!1)return c;if(d instanceof a.HtmlTag)return d.toString();var e=this.getTagBuilder(),f=e.build(b);return f.toString()}},a.link=function(b,c){var d=new a(c);return d.link(b)},a.match={},a.Util={abstractMethod:function(){throw"abstract"},assign:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},extend:function(b,c){var d=b.prototype,e=function(){};e.prototype=d;var f;f=c.hasOwnProperty("constructor")?c.constructor:function(){d.constructor.apply(this,arguments)};var g=f.prototype=new e;return g.constructor=f,g.superclass=d,delete c.constructor,a.Util.assign(g,c),f},ellipsis:function(a,b,c){return a.length>b&&(c=null==c?"..":c,a=a.substring(0,b-c.length)+c),a},indexOf:function(a,b){if(Array.prototype.indexOf)return a.indexOf(b);for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},splitAndCapture:function(a,b){if(!b.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var c,d=[],e=0;c=b.exec(a);)d.push(a.substring(e,c.index)),d.push(c[0]),e=c.index+c[0].length;return d.push(a.substring(e)),d}},a.HtmlParser=a.Util.extend(Object,{htmlRegex:function(){var a=/[0-9a-zA-Z][0-9a-zA-Z:]*/,b=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,c=/(?:".*?"|'.*?'|[^'"=<>`\s]+)/,d=b.source+"(?:\\s*=\\s*"+c.source+")?";return new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",d,"|",c.source+")",")*",">",")","|","(?:","<(/)?","("+a.source+")","(?:","\\s+",d,")*","\\s*/?",">",")"].join(""),"gi")}(),parse:function(a,b){b=b||{};for(var c,d=b.processHtmlNode||function(){},e=b.processTextNode||function(){},f=this.htmlRegex,g=0;null!==(c=f.exec(a));){var h=c[0],i=c[1]||c[3],j=!!c[2],k=a.substring(g,c.index);k&&e(k),d(h,i.toLowerCase(),j),g=c.index+h.length}if(g<a.length){var l=a.substring(g);l&&e(l)}}}),a.HtmlTag=a.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(b){a.Util.assign(this,b),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(a){return this.tagName=a,this},getTagName:function(){return this.tagName||""},setAttr:function(a,b){var c=this.getAttrs();return c[a]=b,this},getAttr:function(a){return this.getAttrs()[a]},setAttrs:function(b){var c=this.getAttrs();return a.Util.assign(c,b),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(a){return this.setAttr("class",a)},addClass:function(b){for(var c,d=this.getClass(),e=this.whitespaceRegex,f=a.Util.indexOf,g=d?d.split(e):[],h=b.split(e);c=h.shift();)-1===f(g,c)&&g.push(c);return this.getAttrs()["class"]=g.join(" "),this},removeClass:function(b){for(var c,d=this.getClass(),e=this.whitespaceRegex,f=a.Util.indexOf,g=d?d.split(e):[],h=b.split(e);g.length&&(c=h.shift());){var i=f(g,c);-1!==i&&g.splice(i,1)}return this.getAttrs()["class"]=g.join(" "),this},getClass:function(){return this.getAttrs()["class"]||""},hasClass:function(a){return-1!==(" "+this.getClass()+" ").indexOf(" "+a+" ")},setInnerHtml:function(a){return this.innerHtml=a,this},getInnerHtml:function(){return this.innerHtml||""},toString:function(){var a=this.getTagName(),b=this.buildAttrsStr();return b=b?" "+b:"",["<",a,b,">",this.getInnerHtml(),"</",a,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var a=this.getAttrs(),b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+'="'+a[c]+'"');return b.join(" ")}}),a.MatchValidator=a.Util.extend(Object,{invalidProtocolRelMatchRegex:/^[\w]\/\//,hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]+:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]+:/,hasWordCharAfterProtocolRegex:/:[^\s]*?[A-Za-z]/,isValidMatch:function(a,b,c){return b&&!this.isValidUriScheme(b)||this.urlMatchDoesNotHaveProtocolOrDot(a,b)||this.urlMatchDoesNotHaveAtLeastOneWordChar(a,b)||this.isInvalidProtocolRelativeMatch(c)?!1:!0},isValidUriScheme:function(a){var b=a.match(this.uriSchemeRegex)[0];return"javascript:"!==b&&"vbscript:"!==b},urlMatchDoesNotHaveProtocolOrDot:function(a,b){return!(!a||b&&this.hasFullProtocolRegex.test(b)||-1!==a.indexOf("."))},urlMatchDoesNotHaveAtLeastOneWordChar:function(a,b){return a&&b?!this.hasWordCharAfterProtocolRegex.test(a):!1},isInvalidProtocolRelativeMatch:function(a){return!!a&&this.invalidProtocolRelMatchRegex.test(a)}}),a.AnchorTagBuilder=a.Util.extend(Object,{constructor:function(b){a.Util.assign(this,b)},build:function(b){var c=new a.HtmlTag({tagName:"a",attrs:this.createAttrs(b.getType(),b.getAnchorHref()),innerHtml:this.processAnchorText(b.getAnchorText())});return c},createAttrs:function(a,b){var c={href:b},d=this.createCssClass(a);return d&&(c["class"]=d),this.newWindow&&(c.target="_blank"),c},createCssClass:function(a){var b=this.className;return b?b+" "+b+"-"+a:""},processAnchorText:function(a){return a=this.doTruncate(a)},doTruncate:function(b){return a.Util.ellipsis(b,this.truncate||Number.POSITIVE_INFINITY)}}),a.match.Match=a.Util.extend(Object,{constructor:function(b){a.Util.assign(this,b)},getType:a.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:a.Util.abstractMethod,getAnchorText:a.Util.abstractMethod}),a.match.Email=a.Util.extend(a.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),a.match.Twitter=a.Util.extend(a.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}}),a.match.Url=a.Util.extend(a.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:!1,getType:function(){return"url"},getUrl:function(){var a=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(a=this.url="http://"+a,this.protocolPrepended=!0),a},getAnchorHref:function(){var a=this.getUrl();return a.replace(/&amp;/g,"&")},getAnchorText:function(){var a=this.getUrl();return this.protocolRelativeMatch&&(a=this.stripProtocolRelativePrefix(a)),this.stripPrefix&&(a=this.stripUrlPrefix(a)),a=this.removeTrailingSlash(a)},stripUrlPrefix:function(a){return a.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(a){return a.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(a){return"/"===a.charAt(a.length-1)&&(a=a.slice(0,-1)),a}}),a})